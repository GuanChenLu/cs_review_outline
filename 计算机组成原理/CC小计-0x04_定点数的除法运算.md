# CC小计 —— 除法运算

> 上节我们学习了定点数的乘法运算，今天我们简单一点，就专门来学习除法运算



## 手算除法

> 首先我们应该约定，对于 `X / y`，除数是 `Y`，被除数是 `X`(强迫症)
>
> 然后我们约定，结果的位数应该和除数的位数相同



对于除法运算 `X / Y`，我们需要判断当前的 `Y` 是否是小于 `X`

1. 如果被除数小于除数，即 `X < Y`，得到的商就是 `0`(就是十进制中的小数)

   反之，用被除数减去除数得部分余数，并且在商上上 `1`

2. 接着我们将除数`Y`右移一位，继续判断直到商符合位数的约定

<img src="https://gitee.com/chenlu-guan/t-image/raw/master/586ea220d9880574203697e0edcd895.jpg" style="zoom:67%;" />



## 计算机中的除法表示

计算机不可能像人一样直观地判断两个数的大小并执行移位操作

计算机采取<u>恢复余数法</u>和<u>加减交替法</u>来表示除法运算



### 恢复余数法

模范人类的做法，计算机先将`被除数`和 `除数`相减，如果结果大于`0`，则执行常规的除法操作，在商上补`1`，相减得到余数继续计算

如果结果小于 `0`，则恢复原数，在商上补 `0`，同时将被除数左移扩大，继续比较的过程

![](https://gitee.com/chenlu-guan/t-image/raw/master/20220314194337.png)

这种方法在早期计算机中使用 `串行1位` 的方式实现，速度太慢已被淘汰



### 加减交替法

在这种方法中，如果出现不够减的情况，可以根据余数的符号继续往下运算，步数固定，控制简单

- 如果余数小于0，商为0，则将余数与除数右移一位相加，继续计算
- 如果余数大于0，商为1，则将余数与除数右移两位相加，继续计算

<img src="https://gitee.com/chenlu-guan/t-image/raw/master/a89d0649bec4cba54e7bc6d143e866e.jpg" style="zoom:67%;" />



> 我们可以看到，采用加减交替法产生加减行为受制于上一次行为的结果，根据此特性，我们设计实现了除法器

在介绍除法器之前，我们先介绍可控加减法器(CAS)



## CAS

当输入端 P 为 0 时执行加法运算，当 P 为 1 时执行减法运算

![](https://gitee.com/chenlu-guan/t-image/raw/master/20220314200105.png)

下面是逻辑公式

![](https://gitee.com/chenlu-guan/t-image/raw/master/20220314200725.png)

为了说明 `CAS` 单元的实际的内部的电路实现，我们将表示 `FA` 的方程式加以变换，使用与/或来实现

![](https://gitee.com/chenlu-guan/t-image/raw/master/9f0427d297cd882610d825b078ad196.jpg)

在这两个表达式中，每一个都可以使用一个 `三级` 的组合逻辑电路实现，因此一个 `CAS` 基本单元的延迟时间是 `3T`



## 加减交替的阵列乘法器

我们以下面这个四位除四位除法器为例

![](https://gitee.com/chenlu-guan/t-image/raw/master/20220314201754.png)

被除数：`X = 0.x6x5x4x3x2x1`(双倍长)

除数：`Y = 0.y3y2y1`

商数：`q = 0.q3q2q1`

余数：`r = 0.00r6r5r4`

其中，最上面一行设置 `p = 1` 首先进行减法运算

当出现不够减的时候，部分余数相对于被除数来说要改变符号，这时应该产生一个商位 `0`，除数`Y`沿对角线右移，然后加到下一行部分余数上

当部分余数不改变它的符号的时候，产生商位为 `1`，下一步操作应该是减法



### 延迟时间

可以看到，一个 `(n + 1) / (n + 1)` 位的除法运算应该由 `(n + 1)^2` 个 `CAS` 单元组成，上文提到 `CAS` 一个单元的延迟为 `3T`，那么总共的延迟时间就是 `3 * (n + 1)^2 T`



对比于加减乘运算 `E * n` 的延迟(E为常数)，除法运算显然更加耗时



<br/><br/>

完

<br/><br/><br/><br/>



---

计算机组成原理小计持续更新，欢迎关注 :smile:









